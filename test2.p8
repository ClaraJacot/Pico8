pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
function _init()
create_player()
init_msg()
end

function _update()
	if #message==0 then
	player_movement()
	end
	check_flag(flag,x,y)
	update_camera()
	update_msg()

end

function _draw()
cls(6)
draw_map()
draw_player()
draw_msg()
end
-->8
--map

function draw_map()
map(0,0,0,0,128,64)
end

function check_flag(flag,x,y)
	local sprite=mget(x,y)
	return fget(sprite,flag)
end

function update_camera()
	local camx =mid(0,p.x-7.5,127-15)
	local camy =mid(0,p.y-7.5,63-15)
	camera(camx*8,camy*8)
end

function next_tiles(x,y)
	local sprite=mget(x,y)
	mset(x,y,sprite+1)
end

function pick_up_shit(x,y)
	next_tiles(x,y)
	p.shit+=1
	sfx(0)
end

function trash_bin(x,y)
	p.shit=0
	sfx(2)
end
-->8
--player

function create_player()
 p={
 	x=5,
 	y=4,
 	sprite=2,
 	speed=0.5,
 	shit=0
 }
end

function player_movement()
	newx=p.x
	newy=p.y
	
	if (btn(⬆️)) newy-=1
	if (btn(⬇️)) newy+=1
	if (btn(⬅️)) newx-=1
	if (btn(➡️)) newx+=1
	
	interact(newx,newy)
	
	if not check_flag(0,newx,newy)then
		p.x=mid(0,newx,127)
		p.y=mid(0,newy,63)
	else
		sfx(1)	
	end
end

function interact(x,y)
	if check_flag(1,x,y) then
		pick_up_shit(x,y)
	elseif check_flag(2,x,y)
	and p.shit>0 then
		trash_bin(x,y)
	end
end

function draw_player()	
	spr(p.sprite,p.x*8,p.y*8)
end
-->8
--messages

function init_msg()
message={}
create_msg("clara","bonjour")
end

function create_msg(name,...)
msg_title=name
message={...}
end

function update_msg()
	if (btnp(❎)) then
		deli(message,1)
	end	
end

function draw_msg()
	if message[1] then
		print (message[1],0,60,7)
	end	
end
__gfx__
000000003333333300eeee00cccccccc000000000555555555555555500000000000000000000000000004000444440000000000000000000000000000000000
000000003b33b33b00effe00cccccccc0000000005555555555555555000000000000000000000000000440044ffff4000000000000000000000000000000000
0070070033b33b3300effe00cccccccc0000000005567567567567555000000000000000000000004444404444f1f14000000000000000000000000000000000
0007700033b33b33000cc000cccccccc0000000005566566566566555000000000000000000000000044444444ffff4000000000000000000000000000000000
000770003b33b33b0cccccc0cccccccc0000000005566566566566555000000000000000000000000044440000aaaa0000000000000000000000000000000000
00700700333333330c0110c0cccccccc000000000555555555555555500000000000000000000000004004000066d60000000000000000000000000000000000
00000000040404040f0110f0cccccccc000000000555555555555555500000000000000000000000004404400aaaaaa000000000000000000000000000000000
000000000404040400777700cccccccc000000000555555555555555500000000000000000000000000000000040040000000000000000000000000000000000
00000000000000000000000000000000000000000556756756756755500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000033333333000000000556656656656655500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000037777773000000000556656656656655500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000037a5a573000000000556656656656655500000000000000000000000000000000000000000000000000000000000000000000000
00000000000e00000000000037777773000000000555555555555555500000000000000000000000000000000000000000000000000000000000000000000000
0000000000eee0000000000033333333000000000555555555555555500000000000000000000000000000000000000000000000000000000000000000000000
000000000eeeee000000000053333335000000000556756756756755500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000556656656656655500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000556656656656655500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000556656656656655500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000555555555555555500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000555555555555555500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000556666675666667500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000556666765666676500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000556666665666666500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000556666665666666500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000555555555555555500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000555555555555555500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000555544444444455500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000555546675667455500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000555546665666455500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000555546665666455500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000555546665666455500000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000555546665666455500000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001000105010101000001000000000000020005010101010000000000000000000000000101010100000000000000000000000001010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0101010101010101010101010101010100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000001000000010100000100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000001100000000000100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000001000000050607000100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000001000014151617000100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010000010101010101252627000100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0104000000000000000034353637000100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0114000000110000000000000000000100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01040506000000000a0000000000000100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0114151600000303030303000011000100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0124252600000000000000000000000100000000000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0134353600000000000000130000000100000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010100000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100000000000000250503135000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000012710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000023140281402b140206401c6500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 01424344

