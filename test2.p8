pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
function _init()
create_player()
init_msg()
end

function _update()
	if #message==0 then
	player_movement()
	end
	check_flag(flag,x,y)
	update_camera()
	update_msg()

end

function _draw()
cls(6)
draw_map()
draw_player()
draw_msg()
end
-->8
--map

function draw_map()
map(0,0,0,0,128,64)
end

function check_flag(flag,x,y)
	local sprite=mget(x,y)
	return fget(sprite,flag)
end

function update_camera()
	local camx =mid(0,p.x-7.5,127-15)
	local camy =mid(0,p.y-7.5,63-15)
	camera(camx*8,camy*8)
end

function next_tiles(x,y)
	local sprite=mget(x,y)
	mset(x,y,sprite+1)
end

function pick_up_shit(x,y)
	next_tiles(x,y)
	p.shit+=1
	sfx(0)
end

function trash_bin(x,y)
	p.shit=0
	sfx(2)
end
-->8
--player

function create_player()
 p={
 	x=5,
 	y=4,
 	sprite=2,
 	speed=0.5,
 	shit=0
 }
end

function player_movement()
	newx=p.x
	newy=p.y
	
	if (btnp(⬆️)) newy-=1
	if (btnp(⬇️)) newy+=1
	if (btnp(⬅️)) newx-=1
	if (btnp(➡️)) newx+=1
	
	interact(newx,newy)
	
	if not check_flag(0,newx,newy)then
		p.x=mid(0,newx,127)
		p.y=mid(0,newy,63)
	else
		sfx(1)	
	end
end

function interact(x,y)
	if check_flag(1,x,y) then
		pick_up_shit(x,y)
	elseif check_flag(2,x,y)
	and p.shit>0 then
		trash_bin(x,y)
	end
	--msg
	if x==8 and y==10 then
		create_msg("dog","ouaf ouaf!")
	end
end

function draw_player()	
	spr(p.sprite,p.x*8,p.y*8)
end
-->8
--messages

function init_msg()
message={}
create_msg("clara","bonjour")
end

function create_msg(name,...)
msg_title=name
message={...}
end

function update_msg()
	if (btnp(❎)) then
		deli(message,1)
	end	
end

function draw_msg()
	if message[1] then
		local y=100
			if p.y%16>=9 then
				y=10
			end	
		print (message[1],0,60,7)
	end	
end
__gfx__
000000003333333300eeee00cccccccc000005555555555555555555555500000000000000000000000004000444440000000005444444404444444400000000
000000003b33b33b00effe00cccccccc0000055555555555555555555555000000000000000000000000440044ffff4000000055544444404444444500000000
0070070033b33b3300effe00cccccccc0000055555567567567567555555000000000000000000004444404444f1f14000000555444444404444444400000000
0007700033b33b33000cc000cccccccc0000055555566566566566555555000000000000000000000044444444ffff4000005555444444404444444400000000
000770003b33b33b0cccccc0cccccccc0000055555566566566566555555000000000000000000000044440000aaaa0000055555444444a04a44444400000000
00700700333333330c0110c0cccccccc000005555555555555555555555500000000000000000000004004000066d60000555555444444404444444400000000
00000000040404040f0110f0cccccccc000005555555555555555555555500000000000000000000004404400aaaaaa005555555544444404444444500000000
000000000404040400777700cccccccc000005555555555555555555555500000000000000000000000000000040040055555555444444404444444400000000
00000000000000000000000000000000000005555556756756756755555500000000000000000000aaffffaaaaa88aaa40000004aaaaaaa0aaaaaaaa00000000
00000000000000000000000033333333000005555556656656656655555500000000000000000000aaffffaaa88888aa455555545aaaaaa0aaaaaaa500000000
00000000000000000000000037777773000005555556656656656655555500000000000000000000affffffaaa888aaa40000004aaaaaaa0aaaaaaaa00000000
00000000000000000000000037a5a573000005555556656656656655555500000000000000000000aaffffaa9a939a9a45555554aaaaaaa0aaaaaaaa00000000
00000000000e00000000000037777773000005555555555555555555555500000000000000000000555555559a9a3a9a40000004aaaaaa404aaaaaaa00000000
0000000000eee0000000000033333333000005555555555555555555555500000000000000000000f555555f9a939a9a45555554aaaaaaa0aaaaaaaa00000000
000000000eeeee000000000053333335000005555556756756756755555500000000000000000000aa1111a49a9a3a9a400000045aaaaaa0aaaaaaa500000000
00000000000000000000000000000000000005555556656656656655555500000000000000000000a77aa7749a939a9a45555554aaaaaaa0aaaaaaaa00000000
0000000000000000000000000000000000000555555665665665665555550000000000000000000000e0e0e00003300045444344aaaaaaaa5555555500000000
000000000000000000000000000000000000055555566566566566555555000000000000000000000eeeeee00033330044444454aaaaaaaa5555555500000000
000000000000000000000000000000000000055555555555555555555555000000000000000000000e44440003333b30444444449a9a9a9a5555555500000000
000000000000000000000000000000000000055555555555555555555555000000000000000000000e4404000333bb30454444449a9a9a9a5555555500000000
000000000000000000000000000000000000055555566666756666655555000000000000000000000ea4440000344300544444449a9a9a9a7755775500000000
0000000000000000000000000000000000000555555666676566667555550000000000000000000000cccc0000044000434444549a9a9a9a5555555500000000
0000000000000000000000000000000000000555555666666566666555550000000000000000000000cc4c0000044000445444349a9a9a9a5555555500000000
000000000000000000000000000000000000055555566666656666655555000000000000000000000077777000444400444444449a9a9a9a5555555500000000
0000000000000000000000000000000000000555555555555555555555550000000000000000000000e0e0e00e0e0e000e0e0e00000000000000000000000000
000000000000000000000000000000000000055555555555555555555555000000000000000000000eeeeee00eeeeee00eeeeee0000000000000000000000000
000000000000000000000000000000000000055555555444444444555555000000000000000000000e4444e0004444e00eeeeee0005555000000000000000000
000000000000000000000000000000000000055555555466756674555555000000000000000000000e4040e0004044e00eeeeee0005566000000000000000000
000000000000000000000000000000000000055555555466656664555555000000000000000000000a444ea000444ae00a4444a08565665a0000000000000000
000000000000000000000000000000000000055555555466656664555555000000000000000000004cccccc400cccc004cccccc4555555550000000000000000
0000000000000000000000000000000000000555555554666566645555550000000000000000000000cccc000ec4cc0000cccc00555555550000000000000000
00000000000000000000000000000000000005555555546665666455555500000000000000000000007007000777770000700700010000100000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10b2b2c2b2b2b2c2c2c2c2c2c2c2b210000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10b2c2c2c2b2c2c2c2c2c2b2c2b2b210000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10b2c2c2c2c2b2c2c2b2d2c2c2c2c210000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10c2c2d2c2c2d2c2c2c2c2d2c2c2c210000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10d2d2c2d2c2d2d2d2d2d2d2d2d2d210000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10d2b1d2d2d2d2d2d2d2d2d2d2d2d210000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10d2d2d2d2b1d2d2d2d2b1d2d2d2d2c2000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10b1d2d2d2d2d2d2d2d2d2d2d2d2d2c2000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10d2b1d2d2d2d2d2d2d2d2d2d2d2b110000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10d2d2b1b1b1b1a1b1b1b1b1b1b1d210000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10d2d2d2d2d2d2d2d2d2d2d2d2d2d210000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10d2b1d2d2d2d2d2d2d2d2d2b1d2d210000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10d2d2d2d2d2d2d2d2d2d2d2d2d2d210000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10c2c2c2d2d2c2c2c2c2c2d2d2d2c210000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10c2d2c2d2c2c2c2c2c2c2c2c2d2c210000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
101010101010d1e11010101010101010101010101010101010101010101010100000000000000000000000000000000000000000000000000000000000000000
__gff__
0001000105010101000001010000000000020005010101010000010100000000000000000101010100000001000000000000000001010101000000000009000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0101010101010101010101010101010101010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000001000000000000000104050607040506070405060405060701000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000001000000000000000114151617141516171415161415161701000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000001000000010100000124252627242526272425262425262701000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000001100000000000134353637343536373435363435363701000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000001000000050607000113000013130000001300001300001301000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000001000000151617000100003d000000000000003d0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01010100000101010101012526000001002e2e2e2e2e2e2e2e2e2e2e2e2e0001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000353600000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000110000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01040506070000000a0000000000000104050604050607000004050607050601000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0114151617000303030303000011000114151614151617000014151617151601000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0124252627000000000000000000000124252624252627000024252627252601000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01343536370000000000001300000001343536343536370b0034353637353601000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01010101010101011c1c01010101010101010101010101000001010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000100000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010101010101010d0e0101010101010101010101010101000001010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100000000000000250503135000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000012710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000023140281402b140206401c6500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 01424344

